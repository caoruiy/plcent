app.service("douban",["http","isDebug",function(t,e){var o=e?"http://localhost:3000/v2/movie/":"http://localhost:4000/v2/movie/";this.inTheaters=function(e,a){return t.get(o+"in_theaters",n(e,a))},this.comingSoon=function(e,a){return t.get(o+"coming_soon",n(e,a))},this.top250=function(e,a){return t.get(o+"top250",n(e,a))},this.detail=function(e){return t.get(o+"subject/"+e)},this.dealReject=function(t){console.log(t)};var n=function(t,e){return{start:(t-1)*e,count:e}}}]),app.controller("movieCtrl",["$scope","douban","$state","$document","$animate",function(t,e,o,n,a){t.pageOption={itemsPerPage:10,currentPage:1,totalItems:1},t.currentStatus={dataType:""},t.inTheaters=[],t.comingSoon=[],t.top250=[],t.inTheatersFun=function(t){c(t,"inTheaters","inTheaters","inTheatersFun")},t.commingSoonFun=function(t){c(t,"comingSoon","comingSoon","commingSoonFun")},t.top250Fun=function(t){c(t,"top250","top250","top250Fun")};var i=function(e,o){t.pageOption={itemsPerPage:e.count,currentPage:parseInt(e.start/e.count)+1,totalItems:e.total},t.currentStatus.dataType=o},c=function(o,n,a,c){o=o||t.pageOption.currentPage,e[n](o,t.pageOption.itemsPerPage).then(function(e){t[a]=e.data.subjects,i(e.data,c)}).catch(function(t){e.dealReject(t)})};t.showDetail=function(t){o.go("movie.detail",{id:t})},t.changeThePage=function(){t[t.currentStatus.dataType](t.pageOption.currentPage)}}]),app.controller("movieDetailCtrl",["$scope","$stateParams","douban","$state","$","$timeout",function(t,e,o,n,a,i){t.movie={},t.movie.id=e.id,o.detail(t.movie.id).then(function(e){t.movie.detail=e.data,i(function(){a(".movie-detail").addClass("show"),a("body").addClass("no-scroll")},1)}).catch(function(t){o.dealReject(t)}),t.goToMovie=function(){n.go("movie"),i(function(){a(".movie-detail").removeClass("show"),a("body").removeClass("no-scroll")},1)}}]);