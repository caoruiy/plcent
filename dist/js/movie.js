app.service("douban",["http","isDebug",function(o,t){var n=t?"http://localhost:4000/v2/movie/":"http://localhost:3000/v2/movie/";this.inTheaters=function(t,e){return o.get(n+"in_theaters",a(t,e))},this.comingSoon=function(t,e){return o.get(n+"coming_soon",a(t,e))},this.top250=function(t,e){return o.get(n+"top250",a(t,e))},this.detail=function(t){return o.get(n+"subject/"+t)},this.dealReject=function(t){console.log(t)};var a=function(t,e){return{start:(t-1)*e,count:e}}}]),app.controller("movieCtrl",["$scope","douban","$state","$document","$animate",function(a,i,e,t,o){a.pageOption={itemsPerPage:10,currentPage:1,totalItems:1},a.currentStatus={dataType:""},a.inTheaters=[],a.comingSoon=[],a.top250=[],a.inTheatersFun=function(t){n(t,"inTheaters","inTheaters","inTheatersFun")},a.commingSoonFun=function(t){n(t,"comingSoon","comingSoon","commingSoonFun")},a.top250Fun=function(t){n(t,"top250","top250","top250Fun")};var n=function(t,e,o,n){t=t||a.pageOption.currentPage,i[e](t,a.pageOption.itemsPerPage).then(function(t){var e;a[o]=t.data.subjects,e=t.data,t=n,a.pageOption={itemsPerPage:e.count,currentPage:parseInt(e.start/e.count)+1,totalItems:e.total},a.currentStatus.dataType=t}).catch(function(t){i.dealReject(t)})};a.showDetail=function(t){e.go("movie.detail",{id:t})},a.changeThePage=function(){a[a.currentStatus.dataType](a.pageOption.currentPage)}}]),app.controller("movieDetailCtrl",["$scope","$stateParams","douban","$state","$","$timeout",function(e,t,o,n,a,i){e.movie={},e.movie.id=t.id,o.detail(e.movie.id).then(function(t){e.movie.detail=t.data,i(function(){a(".movie-detail").addClass("show"),a("body").addClass("no-scroll")},1)}).catch(function(t){o.dealReject(t)}),e.goToMovie=function(){n.go("movie"),i(function(){a(".movie-detail").removeClass("show"),a("body").removeClass("no-scroll")},1)}}]);